jobs:

  test:
    docker: docker://golang:1.11
    entrypoint: |
      pwd
      .scripts/test.sh 'base'

    mount:
      script: /go/src/github.com/boomfunc/root/.scripts
      src: /go/src/github.com/boomfunc/root


  build:
    docker: docker://golang:1.11
    entrypoint: |
      .scripts/build-bin.sh 'base'

    mount:
      script: /go/src/github.com/boomfunc/root/.scripts
      artifact: /go/bin
      src: /go/src/github.com/boomfunc/root


  deploy:
    docker: docker://atlassian/pipelines-awscli
    entrypoint: |
      pwd
      ls -lah /go/bin

    mount:
      artifact: /go/bin

direct: [test, build, deploy]
indirect: [test]
